<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Marbula One</title>
    <link rel="stylesheet" href="./css/styles.css">
    <script src="./js/functions.js" defer></script>
    <script src="./js/ajax.js" defer></script>
    <script type="module" src="./js/cookies.js" defer></script>
    <script src="./js/jquery-3.6.0.js"></script>
    <!-- CSS de Slick Carousel -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick-theme.css"/>
    <!-- JS de Slick Carousel -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.19.5/jquery.validate.min.js"></script>
    <script type="module">
        // Importar las funciones necesarias desde el SDK de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-analytics.js";

        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC-XvaqGJ-OXNoh0KEljj8BT52q7vFoUyo",
            authDomain: "dpwjs-51152.firebaseapp.com",
            databaseURL: "https://dpwjs-51152-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "dpwjs-51152",
            storageBucket: "dpwjs-51152.firebasestorage.app",
            messagingSenderId: "130070489619",
            appId: "1:130070489619:web:ccb77146bc3b8610282de6",
            measurementId: "G-71G81N8YTV"
        };

        // Inicializar Firebase y Analytics
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        // Registrar un evento cuando se cargue la página
        document.addEventListener('DOMContentLoaded', () => {
            logEvent(analytics, 'page_view', {
                page_title: 'Index',
                page_location: window.location.href,
                page_path: window.location.pathname
            });

            console.log("Firebase Analytics: Evento 'page_view' registrado para index.html");
        });
    </script>
</head>
<body>
<header>
    <div class="top">
        <nav>
            <a href="index.html">
                <img class="logo" src="images/logo.png" alt="Logo Marbula One">
                <p class="hide-home">HOME</p>
            </a>

            <!-- Botón del menú hamburguesa -->
            <button class="menu-toggle" aria-label="Abrir menú">&#9776;</button>

            <div class="opciones">
                <div class="dropdown">
                    <p>ACERCA DE</p>
                    <div class="submenu">
                        <ul>
                            <li><a href="html/noticias.html">NOTICIAS</a></li>
                            <li><a href="html/nosotros.html">NOSOTROS</a></li>
                            <li><a href="html/escuderias.html">ESCUDERÍAS</a></li>
                            <li><a href="html/calendario.html">CALENDARIO</a></li>
                            <li><a href="html/normativa.html">NORMATIVA</a></li>
                        </ul>
                    </div>
                </div>

                <div class="dropdown">
                    <p>ACTIVIDADES</p>
                    <div class="submenu">
                        <ul>
                            <li><a href="html/clasificacion.html">CLASIFICACIÓN</a></li>
                            <li><a href="html/campeones.html">CAMPEONES</a></li>
                            <li><a href="html/formacion.html">FORMACIÓN</a></li>
                        </ul>
                    </div>
                </div>

                <div class="otromenu">
                    <ul>
                        <li><a href="html/galeria.html">GALERIA</a></li>
                        <li><a href="html/estadisticas.html">ESTADISTICAS</a></li>
                        <li><a href="html/contacto.html">CONTACTO</a></li>
                        <li><a href="html/tienda.html">TIENDA</a></li>
                    </ul>
                </div>
            </div>
            <div class="search-container">
                <form action="/buscar" method="GET">
                    <input type="text" name="query" placeholder="Buscar..." required>
                </form>
            </div>
        </nav>
    </div>
</header>

<div class="center">
    <!-- Contadores de visitas usando localStorage y sessionStorage -->
    <div id="contador" style="margin: 20px; padding: 10px; border: 1px solid #ccc;">
        <!-- Aquí se mostrará el conteo de visitas -->
    </div>
    <div class="carousel">
        <div>
            <img src="images/propaganda1.jpg" alt="Propaganda 1" style="width: 100%; height: 400px; object-fit: cover;">
        </div>
        <div>
            <img src="images/propaganda2.jpg" alt="Propaganda 2" style="width: 100%; height: 400px; object-fit: cover;">
        </div>
        <div>
            <img src="images/propaganda3.png" alt="Propaganda 3" style="width: 100%; height: 400px; object-fit: cover;">
        </div>
        <div>
            <img src="images/propaganda4.jpg" alt="Propaganda 4" style="width: 100%; height: 400px; object-fit: cover;">
        </div>
    </div>

    <br>
    <div class="clasificacion">
        <h2>Clasificación de la Marbula One</h2>
        <table border="1" cellpadding="10">
            <thead>
            <tr>
                <th>Puesto</th>
                <th>Escudería</th>
                <th>Puntos</th>
                <th>Victorias</th>
                <th>Podios</th>
                <th>Mejor Tiempo</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td>Team Momo</td>
                <td>150</td>
                <td>5</td>
                <td>8</td>
                <td>12.34</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Team Primary</td>
                <td>120</td>
                <td>3</td>
                <td>7</td>
                <td>12.56</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Team Thunder</td>
                <td>110</td>
                <td>2</td>
                <td>6</td>
                <td>12.72</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Team Bubbles</td>
                <td>90</td>
                <td>1</td>
                <td>4</td>
                <td>12.89</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Team Agito</td>
                <td>85</td>
                <td>1</td>
                <td>3</td>
                <td>13.01</td>
            </tr>
            <tr>
                <td>6</td>
                <td>Team Thunderbolts</td>
                <td>70</td>
                <td>0</td>
                <td>2</td>
                <td>13.15</td>
            </tr>
            <tr>
                <td>7</td>
                <td>Team Green</td>
                <td>50</td>
                <td>0</td>
                <td>1</td>
                <td>13.32</td>
            </tr>
            <tr>
                <td>8</td>
                <td>Team Yellow</td>
                <td>30</td>
                <td>0</td>
                <td>0</td>
                <td>13.47</td>
            </tr>
            </tbody>
        </table>
    </div>

    <br>

    <div class="noticias_destacadas">
        <h2>Noticias Destacadas de la Marbula One</h2>

        <div class="noticias_destacadas">
            <!-- Aquí se cargarán las noticias dinámicamente usando AJAX -->
        </div>
    </div>

</div>
<footer>
    <div class="bottom">
        <div class="sponsors">
            <h2>Nuestros Sponsors</h2>
            <section>
                <a href="https://www.adidas.es/" target="_blank">
                    <figure>
                        <img src="images/adidas.png" alt="Logo Adidas" width="100" height="100">
                        <figcaption>SPONSOR TÉCNICO</figcaption>
                    </figure>
                </a>
            </section>
            <section>
                <a href="https://www.iberia.com/" target="_blank">
                    <figure>
                        <img src="images/iberia.jpg" alt="Logo Iberia" width="100" height="100">
                        <figcaption>PATROCINADOR</figcaption>
                    </figure>
                </a>
            </section>
        </div>

        <div class="contacto">
            <h2>Contacto</h2>
            <p>Síguenos en nuestras redes sociales:</p>
            <section>
                <div>
                    <a href="https://www.instagram.com/" target="_blank">
                        <figure>
                            <img src="images/instagram.png" alt="Logo de Instagram" width="40" height="40">
                            <figcaption>Instagram</figcaption>
                        </figure>
                    </a>
                    <a href="https://www.facebook.com/" target="_blank">
                        <figure>
                            <img src="images/facebook.png" alt="Logo de Facebook" width="40" height="40">
                            <figcaption>Facebook</figcaption>
                        </figure>
                    </a>
                    <a href="https://twitter.com/" target="_blank">
                        <figure>
                            <img src="images/x.png" alt="Logo de Twitter" width="40" height="40">
                            <figcaption>Twitter</figcaption>
                        </figure>
                    </a>
                    <a href="https://www.youtube.com/" target="_blank">
                        <figure>
                            <img src="images/youtube.png" alt="Logo de YouTube" width="40" height="40">
                            <figcaption>YouTube</figcaption>
                        </figure>
                    </a>
                </div>
            </section>
        </div>
        <div id="map" style="width:50%;height:300px"></div>
        <div class="cookies">
            <h2><a href="#" id="show-cookies">Cookies</a></h2>
            <div id="cookie-info" style="display: none;">
                <p>En Marbula One, utilizamos las siguientes cookies para mejorar tu experiencia:</p>
                <p>Para más detalles, consulta nuestra <a href="html/politica_cookies.html">Política de Cookies</a>.</p>
            </div>
        </div>
    </div>
    <div class="cookies-banner" id="cookies-banner" style="display: none;">
        <p>
            En Marbula One, utilizamos cookies para mejorar tu experiencia y analizar el tráfico del sitio.
            Consulta nuestra <a href="html/politica_cookies.html" target="_blank">Política de Cookies</a> para más detalles.
        </p>
        <div>
            <button id="accept-cookies">Aceptar Cookies</button>
            <button id="reject-cookies">Rechazar Cookies</button>
        </div>
    </div>
</footer>

</body>
</html>

<script>
    function initMap() {
        // Comprueba si la geolocalización está disponible
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function (position) {
                    // Obtén las coordenadas del usuario
                    var userLat = position.coords.latitude;
                    var userLng = position.coords.longitude;

                    // Opciones del mapa
                    var mapOptions = {
                        center: new google.maps.LatLng(userLat, userLng),
                        zoom: 16,
                        mapTypeId: google.maps.MapTypeId.TERRAIN
                    };

                    // Crea el mapa
                    var map = new google.maps.Map(document.getElementById("map"), mapOptions);

                    // Agrega un marcador en la posición del usuario
                    new google.maps.Marker({
                        position: { lat: userLat, lng: userLng },
                        map: map,
                        title: "¡Estás aquí!"
                    });
                },
                function (error) {
                    // Manejo de errores
                    console.error("Error al obtener la ubicación: ", error.message);
                    alert("No se pudo obtener tu ubicación.");
                }
            );
        } else {
            alert("La geolocalización no es compatible con tu navegador.");
        }
    }
</script>

<!-- Carga la API de Google Maps con tu clave y llama a la función initMap -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC7iCzhZT-L4FlkA_0VZ5qqkJVtQ743vB4&callback=initMap" async defer></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const showCookiesLink = document.getElementById('show-cookies');

        showCookiesLink.addEventListener('click', (event) => {
            event.preventDefault(); // Prevenir el comportamiento por defecto del enlace
            window.location.href = '/html/politica_cookies.html'; // Redirigir a la página
        });
    });
</script>